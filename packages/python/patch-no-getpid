--- Modules/clinic/posixmodule.c.h
+++ Modules/clinic/posixmodule.c.h
@@ -2349,6 +2349,8 @@
 
 #endif /* defined(HAVE_GETGID) */
 
+#if defined(HAVE_GETPID)
+
 PyDoc_STRVAR(os_getpid__doc__,
 "getpid($module, /)\n"
 "--\n"
@@ -2367,6 +2369,8 @@
     return os_getpid_impl(module);
 }
 
+#endif /* defined(HAVE_GETPID) */
+
 #if defined(HAVE_GETGROUPS)
 
 PyDoc_STRVAR(os_getgroups__doc__,
@@ -5841,6 +5845,10 @@
     #define OS_GETGID_METHODDEF
 #endif /* !defined(OS_GETGID_METHODDEF) */
 
+#ifndef OS_GETPID_METHODDEF
+    #define OS_GETPID_METHODDEF
+#endif /* !defined(OS_GETPID_METHODDEF) */
+
 #ifndef OS_GETGROUPS_METHODDEF
     #define OS_GETGROUPS_METHODDEF
 #endif /* !defined(OS_GETGROUPS_METHODDEF) */
--- Modules/posixmodule.c
+++ Modules/posixmodule.c
@@ -5873,6 +5873,7 @@
 #endif /* HAVE_GETGID */
 
 
+#ifdef HAVE_GETPID
 /*[clinic input]
 os.getpid
 
@@ -5885,6 +5886,7 @@
 {
     return PyLong_FromPid(getpid());
 }
+#endif
 
 #ifdef HAVE_GETGROUPLIST
 
