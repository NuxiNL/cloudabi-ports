--- src/estream.c
+++ src/estream.c
@@ -4352,10 +4352,11 @@
   else
     quote = !!quote;
 
-  stream->intern->printable_fname = mem_alloc (strlen (fname) + quote + 1);
+  size_t len = strlen (fname) + 1;
+  stream->intern->printable_fname = mem_alloc (len + quote);
   if (quote)
     stream->intern->printable_fname[0] = '\\';
-  strcpy (stream->intern->printable_fname+quote, fname);
+  memcpy (stream->intern->printable_fname+quote, fname, len);
 }
 
 
